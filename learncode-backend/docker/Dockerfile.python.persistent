FROM python:3.11-slim

WORKDIR /app

# Install websockets library
RUN pip install --no-cache-dir websockets

# Create non-root user
RUN adduser --disabled-password --gecos '' runner && \
    chown -R runner:runner /app

# Copy the executor script
COPY executor-python.py /app/executor.py

USER runner

EXPOSE 8765

# Run the WebSocket server
CMD ["python", "/app/executor.py"]
